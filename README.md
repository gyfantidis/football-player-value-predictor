# Football Player Market Value Predictor

End-to-end machine learning pipeline that predicts professional football player market values from publicly available Transfermarkt data. Trains **separate models per position group** (GK / DEF / MID / ATT) and identifies undervalued players, culminating in a cost-optimised 4-3-3 dream team.

> **DAMA Hackathon 2026** — MSc Data Science & Machine Learning

---

## Results

| Position | Ridge (baseline) | Random Forest | MLP | **XGBoost (best)** |
|---|---|---|---|---|
| GK | 0.712 | 0.781 | 0.775 | **0.788** |
| DEF | 0.764 | 0.826 | 0.815 | **0.827** |
| MID | 0.771 | 0.825 | 0.812 | **0.829** |
| ATT | 0.750 | 0.802 | 0.800 | **0.809** |

**Dream team:** €0.50M total cost → €13.4M model-predicted value (26.7× return)

---

## Pipeline

Run notebooks in order — each depends on the previous:

```
01_data_loading_and_exploration   — sanity checks on raw CSVs
02_eda_raw                        — exploratory data analysis, saves figures/
03_cleaning_and_merging           — merge 7 sources, clean, split by position
04_feature_engineering            — position-specific feature sets
05_preprocessing                  — train/test split, target encoding, scaling
06_baseline_models                — Linear, Ridge, Lasso per position
07_advanced_models                — Random Forest, XGBoost, MLP with tuning
08_evaluation_and_interpretation  — SHAP, residual analysis, error by value range
09_undervalued_players_and_dream_team — score all players, build 4-3-3 squad
10_final_report_and_visualizations    — summary dashboard, composite figures
```

```bash
jupyter lab
# then run notebooks 01 → 10 in sequence
```

---

## Data

Seven CSV files from the [Transfermarkt open dataset](https://github.com/dcaribou/transfermarkt-datasets), placed in `data/raw/`:

| File | Records | Role |
|---|---|---|
| `players.csv` | 34,291 | Player profiles, position, club |
| `appearances.csv` | 1.7M | Per-game stats → aggregated to career totals |
| `player_valuations.csv` | 449K | Value history — latest record kept per player |
| `club_games.csv` | 156K | Clean sheet calculation |
| `game_lineups.csv` | 2.7M | Links players to matches |
| `clubs.csv` | ~450 | League code, squad size |
| `transfers.csv` | 85K | Transfer history |

**Target:** `log_market_value = log1p(market_value_in_eur)` — 30,718 labelled players across 4 position groups.

---

## Models

- **Baseline:** `RidgeCV` / `LassoCV` (5-fold cross-validation)
- **Random Forest:** `RandomizedSearchCV` (n\_iter=20, 5-fold) over depth, features, leaf size
- **XGBoost:** tuned over learning rate, depth, subsample, L1/L2 regularisation (`tree_method='hist'`)
- **MLP:** `MLPRegressor` with Adam, early stopping (patience=20), architecture search over 3-layer sizes

Key design decision: **train/test split before encoding and scaling** to prevent data leakage. League (`current_club_domestic_competition_id`) is target-encoded using training-set means only.

---

## Key Findings (SHAP)

- **League prestige** (`league_mean_value`) is the strongest cross-position driver — *where* you play matters as much as *how*
- **Career peak value** (`log_highest_mv`) anchors market estimates across all positions
- **ATT:** `goals_per_90` becomes the dominant signal
- **GK:** performance stats contribute less; reputation and league quality dominate
- **Age²** captures the inverted-U career arc: value peaks mid-20s, declines sharply post-30

---

## Project Structure

```
notebooks/          10 Jupyter notebooks (run in order)
data/
  raw/              7 source CSVs (not tracked by git)
  processed/        cleaned CSVs, train/test splits, model artifacts
figures/            38 PNG figures generated by notebooks
models/             serialised model files (.pkl)
reports/            technical report + slide deck (md, pdf, pptx)
```

---

## Deliverables

| File | Description |
|---|---|
| [reports/technical_report.md](reports/technical_report.md) | 5-page technical report (conference format) |
| [reports/presentation.pdf](reports/presentation.pdf) | 5-minute slide deck (PDF) |
| [reports/presentation.pptx](reports/presentation.pptx) | 5-minute slide deck (PowerPoint) |
| [notebooks/](notebooks/) | Fully documented pipeline notebooks |
